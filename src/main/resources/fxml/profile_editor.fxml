<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.basis.fingerbrowser.controller.ProfileController"
            prefHeight="600.0" prefWidth="700.0">

    <top>
        <Label text="编辑浏览器配置" style="-fx-font-size: 16; -fx-font-weight: bold">
            <padding>
                <Insets top="10" right="10" bottom="10" left="10"/>
            </padding>
        </Label>
    </top>

    <center>
        <TabPane>
            <Tab text="基本设置" closable="false">
                <ScrollPane fitToWidth="true">
                    <VBox spacing="15.0">
                        <padding>
                            <Insets top="15.0" right="15.0" bottom="15.0" left="15.0"/>
                        </padding>
                        <VBox spacing="5">
                            <Label text="名称 *"/>
                            <TextField fx:id="nameField" promptText="配置名称"/>
                        </VBox>

                        <Separator/>
                        <Label text="浏览器设置" style="-fx-font-weight: bold"/>

                        <GridPane hgap="15" vgap="10">
                            <columnConstraints>
                                <ColumnConstraints hgrow="SOMETIMES" minWidth="100" prefWidth="150"/>
                                <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                            </columnConstraints>

                            <Label text="User-Agent:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                            <ComboBox fx:id="userAgentCombo" editable="true" promptText="选择或输入User-Agent"
                                      GridPane.rowIndex="0" GridPane.columnIndex="1" maxWidth="Infinity"/>

                            <Label text="平台:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                            <ComboBox fx:id="platformCombo" editable="true" promptText="选择平台"
                                      GridPane.rowIndex="1" GridPane.columnIndex="1" maxWidth="Infinity"/>

                            <Label text="语言:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                            <ComboBox fx:id="languageCombo" editable="true" promptText="选择语言"
                                      GridPane.rowIndex="2" GridPane.columnIndex="1" maxWidth="Infinity"/>

                            <Label text="时区:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                            <ComboBox fx:id="timezoneCombo" editable="true" promptText="选择时区"
                                      GridPane.rowIndex="3" GridPane.columnIndex="1" maxWidth="Infinity"/>

                            <Label text="分辨率:" GridPane.rowIndex="4" GridPane.columnIndex="0"/>
                            <ComboBox fx:id="resolutionCombo" editable="true" promptText="选择分辨率"
                                      GridPane.rowIndex="4" GridPane.columnIndex="1" maxWidth="Infinity"/>
                        </GridPane>

                        <Separator/>
                        <Label text="浏览器可执行文件" style="-fx-font-weight: bold"/>
                        <HBox spacing="10">
                            <TextField fx:id="browserPathField" HBox.hgrow="ALWAYS" promptText="留空使用默认浏览器"/>
                            <Button text="浏览..." onAction="#handleBrowseBrowserPath"/>
                        </HBox>
                    </VBox>
                </ScrollPane>
            </Tab>

            <Tab text="指纹保护" closable="false">
                <VBox spacing="15.0">
                    <padding>
                        <Insets top="15.0" right="15.0" bottom="15.0" left="15.0"/>
                    </padding>
                    <Label text="WebRTC防泄漏" style="-fx-font-weight: bold"/>
                    <CheckBox fx:id="webrtcEnabledCheckbox" text="启用WebRTC保护" selected="true"/>
                    <ComboBox fx:id="webrtcPolicyCombo" promptText="选择IP处理策略" maxWidth="Infinity"/>

                    <Separator/>
                    <Label text="Canvas指纹" style="-fx-font-weight: bold"/>
                    <CheckBox fx:id="canvasSpoofCheckbox" text="启用Canvas指纹伪装" selected="true"/>

                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="噪点程度:"/>
                        <Slider fx:id="canvasNoiseSlider" max="10" value="2"
                                showTickLabels="true" showTickMarks="true" majorTickUnit="2"
                                HBox.hgrow="ALWAYS"/>
                    </HBox>

                    <Separator/>
                    <Label text="字体指纹" style="-fx-font-weight: bold"/>
                    <CheckBox fx:id="fontSpoofCheckbox" text="启用字体指纹保护" selected="true"/>

                    <Separator/>
                    <Label text="其他保护" style="-fx-font-weight: bold"/>
                    <CheckBox fx:id="webglCheckbox" text="WebGL指纹保护" selected="true"/>
                    <CheckBox fx:id="audioCheckbox" text="音频指纹保护" selected="true"/>
                </VBox>
            </Tab>

            <Tab text="代理设置" closable="false">
                <VBox spacing="15.0">
                    <padding>
                        <Insets top="15.0" right="15.0" bottom="15.0" left="15.0"/>
                    </padding>
                    <CheckBox fx:id="proxyEnabledCheckbox" text="使用代理" onAction="#handleProxyEnabledChange"/>

                    <GridPane hgap="15" vgap="10" disable="${!proxyEnabledCheckbox.selected}">
                        <columnConstraints>
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="100" prefWidth="120"/>
                            <ColumnConstraints hgrow="ALWAYS" minWidth="200"/>
                        </columnConstraints>

                        <Label text="代理类型:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                        <ComboBox fx:id="proxyTypeCombo"
                                  GridPane.rowIndex="0" GridPane.columnIndex="1" maxWidth="Infinity"/>

                        <Label text="代理服务器:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                        <TextField fx:id="proxyHostField" promptText="主机名或IP地址"
                                   GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                        <Label text="代理端口:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                        <TextField fx:id="proxyPortField" promptText="端口号"
                                   GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                        <CheckBox fx:id="proxyAuthCheckbox" text="需要认证"
                                  GridPane.rowIndex="3" GridPane.columnIndex="0"
                                  GridPane.columnSpan="2"
                                  onAction="#handleProxyAuthChange"/>

                        <Label text="用户名:" GridPane.rowIndex="4" GridPane.columnIndex="0"
                               disable="${!proxyAuthCheckbox.selected}"/>
                        <TextField fx:id="proxyUsernameField" promptText="用户名"
                                   GridPane.rowIndex="4" GridPane.columnIndex="1"
                                   disable="${!proxyAuthCheckbox.selected}"/>

                        <Label text="密码:" GridPane.rowIndex="5" GridPane.columnIndex="0"
                               disable="${!proxyAuthCheckbox.selected}"/>
                        <PasswordField fx:id="proxyPasswordField" promptText="密码"
                                       GridPane.rowIndex="5" GridPane.columnIndex="1"
                                       disable="${!proxyAuthCheckbox.selected}"/>

                        <Button text="测试代理连接" onAction="#handleTestProxy"
                                GridPane.rowIndex="6" GridPane.columnIndex="1"
                                GridPane.halignment="RIGHT"/>
                    </GridPane>
                </VBox>
            </Tab>

            <Tab text="备注" closable="false">
                <VBox spacing="15.0">
                    <padding>
                        <Insets top="15.0" right="15.0" bottom="15.0" left="15.0"/>
                    </padding>
                    <Label text="备注"/>
                    <TextArea fx:id="notesArea" wrapText="true" VBox.vgrow="ALWAYS"/>
                </VBox>
            </Tab>
        </TabPane>
    </center>

    <bottom>
        <HBox alignment="CENTER_RIGHT" spacing="15">
            <padding>
                <Insets top="15.0" right="15.0" bottom="15.0" left="15.0"/>
            </padding>
            <Button text="随机生成设置" onAction="#handleRandomizeSettings"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button text="取消" onAction="#handleCancel"/>
            <Button text="保存" onAction="#handleSave" defaultButton="true"/>
        </HBox>
    </bottom>
</BorderPane>
